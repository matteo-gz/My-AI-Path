<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="实践来源 # https://www.kaggle.com/code/jhoward/is-it-a-bird-creating-a-model-from-your-own-data
在过去识别一个照片中是否有鸟类,需要一个研究团和5年的时间(一个梗图).
前置工作 # fastai库 pip install -Uqq fastai
确保更新,减少兼容性问题
名词解释 # Fine-tune ↕ Fine-tune 是一个英文单词，意思是 微调。在机器学习领域，fine-tune 指的是对已经训练好的模型进行进一步调整，以使其在新的任务上表现更好。 Pretrained ↕ Pretrained 是一个英文单词，意思是 预训练。在机器学习领域，pretrained 指的是使用一个模型在大量数据上进行训练，然后将训练好的模型参数作为另一个模型的初始化参数。 关于data block # 数据块与模型的关联上(数据如何进入我们的模型),在此处的探讨上. 我们似乎跳过了 neural network(神经网络), matrix multiplication(矩阵相乘),gradients(梯度).
但是在实践过程中深度学习社区已经找到了相当小量的模型类型,几乎满足我们的构建需求.
fast.ai库为我们构建正确类型的模型.
数据块设计 # 在数百个项目中,为了使数据达到正确的形状,每个项目进行了哪些更改.
概念 # training set 训练集(用于创建模型的图像) validation set 验证集(在训练期间不使用) 数据集定义 # dls = DataBlock( blocks=(ImageBlock, CategoryBlock), get_items=get_image_files, splitter=RandomSplitter(valid_pct=0.2, seed=42), get_y=parent_label, item_tfms=[Resize(192, method=&#39;squish&#39;)] ).dataloaders(path, bs=32) 数据块 我们有什么样的输入? &ndash; 图像 有什么样的输出? &ndash; 类别 (bird or forest) 那么这个模型中有哪些物品呢?">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="辨别鸟类模型" />
<meta property="og:description" content="实践来源 # https://www.kaggle.com/code/jhoward/is-it-a-bird-creating-a-model-from-your-own-data
在过去识别一个照片中是否有鸟类,需要一个研究团和5年的时间(一个梗图).
前置工作 # fastai库 pip install -Uqq fastai
确保更新,减少兼容性问题
名词解释 # Fine-tune ↕ Fine-tune 是一个英文单词，意思是 微调。在机器学习领域，fine-tune 指的是对已经训练好的模型进行进一步调整，以使其在新的任务上表现更好。 Pretrained ↕ Pretrained 是一个英文单词，意思是 预训练。在机器学习领域，pretrained 指的是使用一个模型在大量数据上进行训练，然后将训练好的模型参数作为另一个模型的初始化参数。 关于data block # 数据块与模型的关联上(数据如何进入我们的模型),在此处的探讨上. 我们似乎跳过了 neural network(神经网络), matrix multiplication(矩阵相乘),gradients(梯度).
但是在实践过程中深度学习社区已经找到了相当小量的模型类型,几乎满足我们的构建需求.
fast.ai库为我们构建正确类型的模型.
数据块设计 # 在数百个项目中,为了使数据达到正确的形状,每个项目进行了哪些更改.
概念 # training set 训练集(用于创建模型的图像) validation set 验证集(在训练期间不使用) 数据集定义 # dls = DataBlock( blocks=(ImageBlock, CategoryBlock), get_items=get_image_files, splitter=RandomSplitter(valid_pct=0.2, seed=42), get_y=parent_label, item_tfms=[Resize(192, method=&#39;squish&#39;)] ).dataloaders(path, bs=32) 数据块 我们有什么样的输入? &ndash; 图像 有什么样的输出? &ndash; 类别 (bird or forest) 那么这个模型中有哪些物品呢?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://matteo-gz.github.io/ai/docs/basic/bird-model/" /><meta property="article:section" content="docs" />


<title>辨别鸟类模型 | ai</title>
<link rel="manifest" href="/ai/manifest.json">
<link rel="icon" href="/ai/favicon.png" >
<link rel="canonical" href="https://matteo-gz.github.io/ai/docs/basic/bird-model/">
<link rel="stylesheet" href="/ai/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css" integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz&#43;OQteg=" crossorigin="anonymous">
  <script defer src="/ai/flexsearch.min.js"></script>
  <script defer src="/ai/en.search.min.aa869e2ccceced134cfa0e8ce89aa48f50c40cd89a4a79c4250e3113b837ffc3.js" integrity="sha256-qoaeLMzs7RNM&#43;g6M6Jqkj1DEDNiaSnnEJQ4xE7g3/8M=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/ai/"><span>ai</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li>
          
  
  

  
    <span>入门</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/ai/docs/basic/start/" class="">前言</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai/docs/basic/machine-learning/" class="">机器学习</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai/docs/basic/deep-learning/" class="">深度学习</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai/docs/basic/production/" class="">生产</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai/docs/basic/neural-network/" class="">神经网络</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai/docs/basic/bird-model/" class="active">辨别鸟类模型</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/ai/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>辨别鸟类模型</strong>

  <label for="toc-control">
    
    <img src="/ai/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#实践来源">实践来源</a></li>
    <li><a href="#前置工作">前置工作</a></li>
    <li><a href="#名词解释">名词解释</a></li>
    <li><a href="#关于data-block">关于data block</a>
      <ul>
        <li><a href="#数据块设计">数据块设计</a></li>
        <li><a href="#概念">概念</a></li>
        <li><a href="#数据集定义">数据集定义</a></li>
      </ul>
    </li>
    <li><a href="#代码">代码</a>
      <ul>
        <li><a href="#前置依赖">前置依赖</a></li>
        <li><a href="#mainpy">main.py</a></li>
        <li><a href="#文件目录">文件目录</a></li>
        <li><a href="#运行脚本">运行脚本</a></li>
        <li><a href="#输出结果">输出结果</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h2 id="实践来源">
  实践来源
  <a class="anchor" href="#%e5%ae%9e%e8%b7%b5%e6%9d%a5%e6%ba%90">#</a>
</h2>
<p><a href="https://www.kaggle.com/code/jhoward/is-it-a-bird-creating-a-model-from-your-own-data">https://www.kaggle.com/code/jhoward/is-it-a-bird-creating-a-model-from-your-own-data</a></p>
<p>在过去识别一个照片中是否有鸟类,需要一个研究团和5年的时间(一个梗图).</p>
<h2 id="前置工作">
  前置工作
  <a class="anchor" href="#%e5%89%8d%e7%bd%ae%e5%b7%a5%e4%bd%9c">#</a>
</h2>
<p>fastai库
<code>pip install -Uqq fastai</code></p>
<p>确保更新,减少兼容性问题</p>
<h2 id="名词解释">
  名词解释
  <a class="anchor" href="#%e5%90%8d%e8%af%8d%e8%a7%a3%e9%87%8a">#</a>
</h2>

<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>Fine-tune</span>
      <span>↕</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      <pre tabindex="0"><code>Fine-tune 是一个英文单词，意思是 微调。在机器学习领域，fine-tune 指的是对已经训练好的模型进行进一步调整，以使其在新的任务上表现更好。
</code></pre>
    </div>
  </label>
</div>


<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>Pretrained</span>
      <span>↕</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      <pre tabindex="0"><code>Pretrained 是一个英文单词，意思是 预训练。在机器学习领域，pretrained 指的是使用一个模型在大量数据上进行训练，然后将训练好的模型参数作为另一个模型的初始化参数。
</code></pre>
    </div>
  </label>
</div>

<h2 id="关于data-block">
  关于data block
  <a class="anchor" href="#%e5%85%b3%e4%ba%8edata-block">#</a>
</h2>
<p>数据块与模型的关联上(数据如何进入我们的模型),在此处的探讨上.
我们似乎跳过了 neural network(神经网络), matrix multiplication(矩阵相乘),gradients(梯度).</p>
<p>但是在实践过程中深度学习社区已经找到了相当小量的模型类型,几乎满足我们的构建需求.</p>
<p>fast.ai库为我们构建正确类型的模型.</p>
<h3 id="数据块设计">
  数据块设计
  <a class="anchor" href="#%e6%95%b0%e6%8d%ae%e5%9d%97%e8%ae%be%e8%ae%a1">#</a>
</h3>
<p>在数百个项目中,为了使数据达到正确的形状,每个项目进行了哪些更改.</p>
<h3 id="概念">
  概念
  <a class="anchor" href="#%e6%a6%82%e5%bf%b5">#</a>
</h3>
<ul>
<li>training set 训练集(用于创建模型的图像)</li>
<li>validation set 验证集(在训练期间不使用)</li>
</ul>
<h3 id="数据集定义">
  数据集定义
  <a class="anchor" href="#%e6%95%b0%e6%8d%ae%e9%9b%86%e5%ae%9a%e4%b9%89">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>dls <span style="color:#f92672">=</span> DataBlock(
</span></span><span style="display:flex;"><span>    blocks<span style="color:#f92672">=</span>(ImageBlock, CategoryBlock),
</span></span><span style="display:flex;"><span>    get_items<span style="color:#f92672">=</span>get_image_files, 
</span></span><span style="display:flex;"><span>    splitter<span style="color:#f92672">=</span>RandomSplitter(valid_pct<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>, seed<span style="color:#f92672">=</span><span style="color:#ae81ff">42</span>),
</span></span><span style="display:flex;"><span>    get_y<span style="color:#f92672">=</span>parent_label,
</span></span><span style="display:flex;"><span>    item_tfms<span style="color:#f92672">=</span>[Resize(<span style="color:#ae81ff">192</span>, method<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;squish&#39;</span>)]
</span></span><span style="display:flex;"><span>)<span style="color:#f92672">.</span>dataloaders(path, bs<span style="color:#f92672">=</span><span style="color:#ae81ff">32</span>)
</span></span></code></pre></div><ul>
<li>数据块
<ul>
<li>我们有什么样的输入? &ndash; 图像</li>
<li>有什么样的输出? &ndash; 类别 (bird or forest)</li>
</ul>
</li>
<li>那么这个模型中有哪些物品呢?  &ndash; 图像文件列表</li>
<li>留出一些数据来测试模型的准确性(验证集) &ndash; 随机20%</li>
<li>我们如何知道一张照片的正确标签,我们如何知道这是一张鸟类照片还是一张森林照片? &ndash; 标签的来源,通过图片返回其文件夹(包含标签)</li>
<li>项目转换;图片大小转换为192 by 192像素. 通过 squish</li>
</ul>
<p>以上步骤通过GPU 并行执行出一个 &ldquo;batch&rdquo; or &ldquo;mini batch&rdquo;</p>
<p>分离器的类型大全</p>
<ul>
<li><a href="https://docs.fast.ai/tutorial.datablock.html">https://docs.fast.ai/tutorial.datablock.html</a></li>
<li><a href="https://docs.fast.ai/data.block.html">https://docs.fast.ai/data.block.html</a></li>
</ul>
<p>图像模型</p>
<ul>
<li><a href="https://github.com/huggingface/pytorch-image-models">https://github.com/huggingface/pytorch-image-models</a></li>
</ul>
<h2 id="代码">
  代码
  <a class="anchor" href="#%e4%bb%a3%e7%a0%81">#</a>
</h2>
<h3 id="前置依赖">
  前置依赖
  <a class="anchor" href="#%e5%89%8d%e7%bd%ae%e4%be%9d%e8%b5%96">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pip install -Uqq fastai duckduckgo_search
</span></span></code></pre></div><h3 id="mainpy">
  main.py
  <a class="anchor" href="#mainpy">#</a>
</h3>

<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>code</span>
      <span>↕</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> multiprocessing
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># add this import</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    multiprocessing<span style="color:#f92672">.</span>freeze_support()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> duckduckgo_search <span style="color:#f92672">import</span> DDGS
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> fastcore.all <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ddgs <span style="color:#f92672">=</span> DDGS()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">search_images</span>(term, max_images<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Searching for &#39;</span><span style="color:#e6db74">{</span>term<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#     return L(ddg_images(term, max_results=max_images)).itemgot(&#39;image&#39;)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> L(ddgs<span style="color:#f92672">.</span>images(keywords<span style="color:#f92672">=</span>term, max_results<span style="color:#f92672">=</span>max_images))<span style="color:#f92672">.</span>itemgot(<span style="color:#e6db74">&#39;image&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    urls <span style="color:#f92672">=</span> search_images(<span style="color:#e6db74">&#39;bird photos&#39;</span>, max_images<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    urls[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    print(urls[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> fastdownload <span style="color:#f92672">import</span> download_url
</span></span><span style="display:flex;"><span>    dest <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;bird.jpg&#39;</span>
</span></span><span style="display:flex;"><span>    download_url(urls[<span style="color:#ae81ff">0</span>], dest, show_progress<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> fastai.vision.all <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>    im <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(dest)
</span></span><span style="display:flex;"><span>    im<span style="color:#f92672">.</span>to_thumb(<span style="color:#ae81ff">256</span>,<span style="color:#ae81ff">256</span>)
</span></span><span style="display:flex;"><span>    download_url(search_images(<span style="color:#e6db74">&#39;forest photos&#39;</span>, max_images<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">0</span>], <span style="color:#e6db74">&#39;forest.jpg&#39;</span>, show_progress<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>    Image<span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#39;forest.jpg&#39;</span>)<span style="color:#f92672">.</span>to_thumb(<span style="color:#ae81ff">256</span>,<span style="color:#ae81ff">256</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    searches <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;forest&#39;</span>,<span style="color:#e6db74">&#39;bird&#39;</span>
</span></span><span style="display:flex;"><span>    path <span style="color:#f92672">=</span> Path(<span style="color:#e6db74">&#39;bird_or_not&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> time <span style="color:#f92672">import</span> sleep
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> fastai.vision.all <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> o <span style="color:#f92672">in</span> searches:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># continue</span>
</span></span><span style="display:flex;"><span>        dest <span style="color:#f92672">=</span> (path<span style="color:#f92672">/</span>o)
</span></span><span style="display:flex;"><span>        dest<span style="color:#f92672">.</span>mkdir(exist_ok<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, parents<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>        download_images(dest, urls<span style="color:#f92672">=</span>search_images(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>o<span style="color:#e6db74">}</span><span style="color:#e6db74"> photo&#39;</span>))
</span></span><span style="display:flex;"><span>        sleep(<span style="color:#ae81ff">10</span>)  <span style="color:#75715e"># Pause between searches to avoid over-loading server</span>
</span></span><span style="display:flex;"><span>        download_images(dest, urls<span style="color:#f92672">=</span>search_images(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>o<span style="color:#e6db74">}</span><span style="color:#e6db74"> sun photo&#39;</span>))
</span></span><span style="display:flex;"><span>        sleep(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>        download_images(dest, urls<span style="color:#f92672">=</span>search_images(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>o<span style="color:#e6db74">}</span><span style="color:#e6db74"> shade photo&#39;</span>))
</span></span><span style="display:flex;"><span>        sleep(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>        resize_images(path<span style="color:#f92672">/</span>o, max_size<span style="color:#f92672">=</span><span style="color:#ae81ff">400</span>, dest<span style="color:#f92672">=</span>path<span style="color:#f92672">/</span>o)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    failed <span style="color:#f92672">=</span> verify_images(get_image_files(path))
</span></span><span style="display:flex;"><span>    failed<span style="color:#f92672">.</span>map(Path<span style="color:#f92672">.</span>unlink)
</span></span><span style="display:flex;"><span>    len(failed)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dls <span style="color:#f92672">=</span> DataBlock(
</span></span><span style="display:flex;"><span>        blocks<span style="color:#f92672">=</span>(ImageBlock, CategoryBlock),
</span></span><span style="display:flex;"><span>        get_items<span style="color:#f92672">=</span>get_image_files,
</span></span><span style="display:flex;"><span>        splitter<span style="color:#f92672">=</span>RandomSplitter(valid_pct<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>, seed<span style="color:#f92672">=</span><span style="color:#ae81ff">42</span>),
</span></span><span style="display:flex;"><span>        get_y<span style="color:#f92672">=</span>parent_label,
</span></span><span style="display:flex;"><span>        item_tfms<span style="color:#f92672">=</span>[Resize(<span style="color:#ae81ff">192</span>, method<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;squish&#39;</span>)]
</span></span><span style="display:flex;"><span>    )<span style="color:#f92672">.</span>dataloaders(path, bs<span style="color:#f92672">=</span><span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dls<span style="color:#f92672">.</span>show_batch(max_n<span style="color:#f92672">=</span><span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    learn <span style="color:#f92672">=</span> vision_learner(dls, resnet18, metrics<span style="color:#f92672">=</span>error_rate)
</span></span><span style="display:flex;"><span>    learn<span style="color:#f92672">.</span>fine_tune(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    is_bird,_,probs <span style="color:#f92672">=</span> learn<span style="color:#f92672">.</span>predict(PILImage<span style="color:#f92672">.</span>create(<span style="color:#e6db74">&#39;bird.jpg&#39;</span>))
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;This is a: </span><span style="color:#e6db74">{</span>is_bird<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Probability it&#39;s a bird: </span><span style="color:#e6db74">{</span>probs[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    is_bird, _, probs <span style="color:#f92672">=</span> learn<span style="color:#f92672">.</span>predict(PILImage<span style="color:#f92672">.</span>create(<span style="color:#e6db74">&#39;forest.jpg&#39;</span>))
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;This is a: </span><span style="color:#e6db74">{</span>is_bird<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Probability it&#39;s a bird: </span><span style="color:#e6db74">{</span>probs[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div>
    </div>
  </label>
</div>

<h3 id="文件目录">
  文件目录
  <a class="anchor" href="#%e6%96%87%e4%bb%b6%e7%9b%ae%e5%bd%95">#</a>
</h3>
<pre tabindex="0"><code>.
├── bird.jpg
├── bird_or_not
│   ├── bird
│   └── forest
├── forest.jpg
├── main.py
└── venv
    ├── bin
    ├── lib
    └── pyvenv.cfg
</code></pre><h3 id="运行脚本">
  运行脚本
  <a class="anchor" href="#%e8%bf%90%e8%a1%8c%e8%84%9a%e6%9c%ac">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>/usr/bin/python3 main.py
</span></span></code></pre></div><h3 id="输出结果">
  输出结果
  <a class="anchor" href="#%e8%be%93%e5%87%ba%e7%bb%93%e6%9e%9c">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>epoch     train_loss  valid_loss  error_rate  time    
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span>         0.732300    0.141044    0.046512    00:12                                               
</span></span><span style="display:flex;"><span>epoch     train_loss  valid_loss  error_rate  time    
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span>         0.183334    0.021051    0.000000    00:09                                               
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>         0.115255    0.014208    0.000000    00:04                                               
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>         0.075642    0.008127    0.000000    00:03                                               
</span></span><span style="display:flex;"><span>This is a: bird.                                                                
</span></span><span style="display:flex;"><span>Probability it<span style="color:#e6db74">&#39;s a bird: 1.0000
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">This is a: forest.                                                              
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Probability it&#39;</span>s a bird: 0.0000
</span></span></code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#实践来源">实践来源</a></li>
    <li><a href="#前置工作">前置工作</a></li>
    <li><a href="#名词解释">名词解释</a></li>
    <li><a href="#关于data-block">关于data block</a>
      <ul>
        <li><a href="#数据块设计">数据块设计</a></li>
        <li><a href="#概念">概念</a></li>
        <li><a href="#数据集定义">数据集定义</a></li>
      </ul>
    </li>
    <li><a href="#代码">代码</a>
      <ul>
        <li><a href="#前置依赖">前置依赖</a></li>
        <li><a href="#mainpy">main.py</a></li>
        <li><a href="#文件目录">文件目录</a></li>
        <li><a href="#运行脚本">运行脚本</a></li>
        <li><a href="#输出结果">输出结果</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












